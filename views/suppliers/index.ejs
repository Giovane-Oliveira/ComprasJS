<%-  include('../partials/header.ejs') %>

    
<% if(message) {  %>
    <script>
         $(document).ready(function() {
           $('#message').modal('show');
        });
    </script>
    <% } %>
  

    <h2 class='mb-4'>Gerenciamento de Fornecedores</h2>
    
    <br>
    <table id="example" class="table table-striped table-bordered"
        style="width: 100%">

        <thead>
            <tr>
                <th>Id</th>
                <th>CNPJ</th>
                <th>Nome</th>
                <th>Status</th>
                <th>Excluir</th>
            </tr>
        </thead>
        <tbody>
            
            
               <% suppliers.forEach(supplier => { %>
             
                <tr>
                    <td> <%= supplier.id %> </td> 
                    <td> <%= supplier.cnpj %> </td> 
                    <td> <%= supplier.name %> </td> 
                
                    
                        <% if(supplier.status == 1){%>
                            <td> <input id=<%=supplier.id %> type="checkbox" checked data-toggle="toggle" data-onstyle="success"  data-size="xs"></td>
                   <% }else{ %>
                         <td> <input id=<%=supplier.id %> type="checkbox" unchecked data-toggle="toggle" data-onstyle="success"  data-size="xs"></td>
                   <% } %>
                     
                    <td><a href="delete_supplier/<%= supplier.id %>"> <button ><i class="fa fa-trash-o"></i></button> </a></td>      	
                </tr>      
                
             <%  }); %>
    
             <script type="text/javascript">
	
		
                $('input:checkbox').change(
                        function(){
                            if ($(this).is(':checked')) {
                               // alert($(this).attr("id"));
                                window.location.href = "/activate_supplier/" + $(this).attr("id"); 
                            }else{
                                
                                //alert($(this).attr("id"));
                                window.location.href = "desactivate_supplier/" + $(this).attr("id"); 
                            }
                        });
                
                </script>
            
            
        </tbody>
    </table>
</div>
    </div>

  


<script type="text/javascript">

var table = new DataTable('#example', {
    language: {
        url: '//cdn.datatables.net/plug-ins/2.0.3/i18n/pt-BR.json',
    },
    
    order: 'desc'
});
    
</script>



		    <!-- Modal -->
            <div class="modal fade" id="message" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLongTitle">Aviso</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <%= message %>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>




<%- include('../partials/footer.ejs') %>