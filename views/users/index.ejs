<%- include('../partials/header.ejs') %>


  <% if(message) { %>
    <script>
      $(document).ready(function () {
        $('#message').modal('show');
      });
    </script>
    <% } %>
      <a href="/dashboard"><img src="../images/icon-white.svg" style="width:180px; height:180px; margin-top:-102px; margin-left: -25px"></a>

      <h2 class='mb-4' style="margin-top:25px">Gerenciamento de Usuários</h2>

      <table id="example" class="table table-striped table-bordered" style="width: 100%">

        <thead>
          <tr>
            <th>Id</th>
            <th>Login</th>
            <th>Status</th>
            <th>Permissões</th>
          </tr>
        </thead>
        <tbody>


          <% listusers.forEach(usuario=> { %>

            <tr>
              <td>
                <%= usuario.id %>
              </td>
              <td>
                <%= usuario.login %>
              </td>

              <% if(usuario.active==1){%>
                <td> <input id=<%=usuario.id %> type="checkbox" checked data-toggle="toggle" data-onstyle="success" data-size="xs"></td>
                <% }else{ %>
                  <td> <input id=<%=usuario.id %> type="checkbox" unchecked data-toggle="toggle" data-onstyle="success" data-size="xs"></td>
                  <% } %>

                    <td>
                      <a href="/permission/<%= usuario.id %>" class="btn btn-warning">Abrir</a>
                    </td>

            </tr>

            <% }); %>

              <script type="text/javascript">


                $('input:checkbox').change(
                  function () {
                    if ($(this).is(':checked')) {
                      // alert($(this).attr("id"));
                      window.location.href = "/activate_user/" + $(this).attr("id");
                    } else {

                      //alert($(this).attr("id"));
                      window.location.href = "/desactivate_user/" + $(this).attr("id");
                    }
                  });

              </script>


        </tbody>
      </table>





      <script type="text/javascript">

        var table = new DataTable('#example', {
          language: {
            url: '//cdn.datatables.net/plug-ins/2.0.3/i18n/pt-BR.json',
          },

          order: 'desc'
        });

      </script>



      <!-- Modal -->
      <div class="modal fade" id="message" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLongTitle">Aviso</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <%= message %>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>




      <%- include('../partials/footer.ejs') %>